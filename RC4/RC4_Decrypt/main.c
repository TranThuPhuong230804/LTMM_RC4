#include <stdio.h>
#include <string.h>
#include "rc4.h"

int main(void){
    const char *key = "HUST2025";
    unsigned char ciphertext[] = { 0xBA, 0x0F, 0xCE, 0xAF, 0xE5, 0xE8, 0x85, 0xC2, 0x12, 0x27, 0x31, 0x3A, 0x9A, 0xB1, 0xF2, 0x27, 0xF6, 0x75, 0x3C, 0xDF, 0x66, 0x96, 0xD4, 0xED, 0xB4, 0x8F, 0x5E, 0x59, 0x5F, 0xC0, 0x04, 0x6E, 0x9A, 0xDA, 0xE7, 0x5A, 0xAE, 0xD0, 0x65, 0xA8, 0xDB, 0xA6 };
    size_t n = sizeof(ciphertext)/sizeof(ciphertext[0]);
    unsigned char decrypted[512];

    RC4State st;
    rc4_init(&st, (const unsigned char*)key, strlen(key));
    rc4_crypt(&st, ciphertext, decrypted, n);
    decrypted[n] = '\0';

    printf("Key: %s\n", key);
    printf("Decrypted: %s\n", decrypted);
    return 0;
}
